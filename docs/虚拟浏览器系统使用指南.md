# Godotè™šæ‹Ÿæµè§ˆå™¨ç³»ç»Ÿä½¿ç”¨æŒ‡å—

## æ¦‚è¿°

Godotè™šæ‹Ÿæµè§ˆå™¨ç³»ç»Ÿå…è®¸ä½ åœ¨Godot 3Dåœºæ™¯ä¸­åµŒå…¥å’Œæ§åˆ¶æµè§ˆå™¨ç•Œé¢ï¼Œå®ç°AGUIï¼ˆAdvanced GUIï¼‰åŠŸèƒ½ã€‚è¯¥ç³»ç»Ÿé€šè¿‡WebSocketå®ç°Godotä¸æµè§ˆå™¨è¿›ç¨‹çš„åŒå‘å®æ—¶é€šä¿¡ã€‚

## ç³»ç»Ÿæ¶æ„

```
Godot 3D ä¸»è¿›ç¨‹                    æµè§ˆå™¨è¾…åŠ©è¿›ç¨‹
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BrowserManager â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   AGUI Server   â”‚
â”‚                 â”‚ WebSocket    â”‚   (Node.js)     â”‚
â”‚ VirtualBrowser3Dâ”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                 â”‚
â”‚ BrowserInputMgr â”‚              â”‚ Chrome Browser â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

ç¡®ä¿ç³»ç»Ÿå·²å®‰è£…ï¼š
- **Node.js 16+** (è¿è¡ŒAGUIæœåŠ¡å™¨)
- **Google Chrome** æˆ–å…¶ä»–Chromiumæµè§ˆå™¨
- **Godot 4.2+**

### 2. å®‰è£…ä¾èµ–

```bash
cd /path/to/godot-pet
npm install
```

### 3. å¯åŠ¨AGUIæœåŠ¡å™¨

```bash
# å¯åŠ¨WebSocketæœåŠ¡å™¨å’ŒHTTPæœåŠ¡
npm start

# æˆ–è€…å¼€å‘æ¨¡å¼ï¼ˆè‡ªåŠ¨é‡å¯ï¼‰
npm run dev
```

æœåŠ¡å™¨å°†åœ¨ä»¥ä¸‹ç«¯å£å¯åŠ¨ï¼š
- **HTTP**: http://localhost:3000 (AGUIç•Œé¢)
- **WebSocket**: ws://localhost:8080 (é€šä¿¡æ¥å£)

### 4. è¿è¡ŒGodotæ¼”ç¤º

åœ¨Godotç¼–è¾‘å™¨ä¸­ï¼š
1. æ‰“å¼€é¡¹ç›® `project.godot`
2. è¿è¡Œåœºæ™¯ `scenes/browser_demo.tscn`
3. æˆ–è€…åœ¨ä¸»åœºæ™¯ä¸­é›†æˆBrowserManager

## æ ¸å¿ƒç»„ä»¶

### BrowserManager

ç³»ç»Ÿæ ¸å¿ƒç®¡ç†å™¨ï¼Œè´Ÿè´£åè°ƒæ‰€æœ‰æµè§ˆå™¨ç›¸å…³ç»„ä»¶ã€‚

**ä¸»è¦æ–¹æ³•ï¼š**
```gdscript
# å¯åŠ¨æµè§ˆå™¨ç³»ç»Ÿ
browser_manager.start_browser_system()

# è®¾ç½®æµè§ˆå™¨æ¨¡å¼
browser_manager.set_browser_mode(BrowserManager.BrowserMode.WINDOW_3D)

# å¯¼èˆªåˆ°URL
browser_manager.navigate_to_url("http://localhost:3000")

# æ‰§è¡ŒJavaScript
browser_manager.inject_javascript("console.log('Hello!');")

# å‘é€é¼ æ ‡äº‹ä»¶
browser_manager.simulate_mouse_event("click", 100, 200)
```

### VirtualBrowser3D

3Dåœºæ™¯ä¸­çš„æµè§ˆå™¨æ˜¾ç¤ºç»„ä»¶ã€‚

**å±æ€§è®¾ç½®ï¼š**
```gdscript
virtual_browser.browser_width = 1920
virtual_browser.browser_height = 1080
virtual_browser.scale_factor = 0.01  # 3Dæ˜¾ç¤ºç¼©æ”¾
```

### BrowserInputManager

å¤„ç†ç”¨æˆ·è¾“å…¥åˆ°æµè§ˆå™¨çš„æ˜ å°„ã€‚

**é…ç½®ï¼š**
```gdscript
browser_input.enable_browser_input = true
browser_input.interaction_distance = 10.0  # æœ€å¤§äº¤äº’è·ç¦»
browser_input.drag_threshold = 10.0  # æ‹–æ‹½åˆ¤å®šé˜ˆå€¼
```

## æµè§ˆå™¨æ¨¡å¼

ç³»ç»Ÿæ”¯æŒ4ç§æ˜¾ç¤ºæ¨¡å¼ï¼š

### 1. HIDDEN (éšè—)
æµè§ˆå™¨ä¸å¯è§ï¼Œä¸å¤„ç†ä»»ä½•äº¤äº’ã€‚

### 2. WINDOW_3D (3Dçª—å£) â­æ¨è
åœ¨3Dç©ºé—´ä¸­æ˜¾ç¤ºæµè§ˆå™¨çª—å£ï¼Œæ”¯æŒå®Œæ•´çš„3Då˜æ¢ã€‚

**ç‰¹ç‚¹ï¼š**
- æµè§ˆå™¨ä½œä¸º3Dç‰©ä½“å­˜åœ¨äºåœºæ™¯ä¸­
- æ”¯æŒä½ç½®ã€æ—‹è½¬ã€ç¼©æ”¾å˜æ¢
- é¼ æ ‡äº¤äº’åŸºäº3Då°„çº¿æ£€æµ‹

### 3. OVERLAY_2D (2Dè¦†ç›–å±‚)
æµè§ˆå™¨ä½œä¸º2Dè¦†ç›–å±‚æ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚

### 4. FULLSCREEN (å…¨å±)
æµè§ˆå™¨å æ»¡æ•´ä¸ªå±å¹•ã€‚

## AGUIç•Œé¢åŠŸèƒ½

AGUIç•Œé¢æä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š

### ğŸ¯ æŒ‡ä»¤æ§åˆ¶
- **æ–‡å­—æŒ‡ä»¤è¾“å…¥**ï¼šå‘é€æ–‡æœ¬å‘½ä»¤åˆ°èŒå® AI
- **å®æ—¶åé¦ˆ**ï¼šæ˜¾ç¤ºå‘½ä»¤æ‰§è¡ŒçŠ¶æ€

### ğŸ­ åŠ¨ç”»æ§åˆ¶
- **åŠ¨ç”»æŒ‰é’®ç½‘æ ¼**ï¼šä¸€é”®è§¦å‘å„ç§åŠ¨ä½œ
- **è§†è§‰åé¦ˆ**ï¼šæ˜¾ç¤ºå½“å‰æ’­æ”¾åŠ¨ç”»

### ğŸ“Š çŠ¶æ€ç›‘æ§
- **å®æ—¶çŠ¶æ€**ï¼šèƒ½é‡å€¼ã€æ— èŠåº¦ã€å½“å‰åŠ¨ä½œ
- **è¿æ¥çŠ¶æ€**ï¼šWebSocketè¿æ¥çŠ¶æ€æŒ‡ç¤º

### ğŸ’¬ å¯¹è¯è®°å½•
- **æ¶ˆæ¯å†å²**ï¼šæ˜¾ç¤ºAIå¯¹è¯è®°å½•
- **è§’è‰²åŒºåˆ†**ï¼šç”¨æˆ·å’ŒåŠ©æ‰‹æ¶ˆæ¯æ ·å¼ä¸åŒ

### ğŸ® é«˜çº§æ§åˆ¶
- **é‡ç½®ä½ç½®**ï¼šå°†èŒå® é‡ç½®åˆ°åˆå§‹ä½ç½®
- **éšæœºåŠ¨ä½œ**ï¼šè§¦å‘éšæœºåŠ¨ç”»
- **AIåˆ‡æ¢**ï¼šå¼€å¯/å…³é—­AIè¡Œä¸º
- **çŠ¶æ€ä¿å­˜**ï¼šä¿å­˜å½“å‰æ¸¸æˆçŠ¶æ€

## äº¤äº’æ“ä½œ

### é¼ æ ‡äº¤äº’
- **æ‚¬åœ**ï¼šé¼ æ ‡ç§»åŠ¨åˆ°æµè§ˆå™¨ä¸Šæ—¶é«˜äº®
- **ç‚¹å‡»**ï¼šåœ¨æµè§ˆå™¨ä¸Šç‚¹å‡»è§¦å‘ç›¸åº”æ“ä½œ
- **æ‹–æ‹½**ï¼šæ‹–æ‹½æµè§ˆå™¨çª—å£ç§»åŠ¨ä½ç½®

### é”®ç›˜å¿«æ·é”®
- **F1**ï¼šåˆ‡æ¢æµè§ˆå™¨æ˜¾ç¤ºæ¨¡å¼
- **F2**ï¼šæ‰“å¼€AGUIç•Œé¢
- **F3**ï¼šæ‰§è¡Œæµ‹è¯•å‘½ä»¤
- **ESC**ï¼šé€€å‡ºæ¼”ç¤º

## é€šä¿¡åè®®

### WebSocketæ¶ˆæ¯æ ¼å¼

#### Godot â†’ æœåŠ¡å™¨
```json
{
  "type": "agui_command",
  "timestamp": 1234567890,
  "data": {
    "command": "text_instruction",
    "params": {
      "text": "è·³èˆ"
    }
  }
}
```

#### æœåŠ¡å™¨ â†’ Godot
```json
{
  "type": "pet_status",
  "timestamp": 1234567890,
  "data": {
    "energy": 95,
    "boredom": 10,
    "current_action": "DANCE"
  }
}
```

#### æµè§ˆå™¨äº‹ä»¶
```json
{
  "type": "browser_event",
  "timestamp": 1234567890,
  "data": {
    "event_type": "click",
    "element_id": "dance_button",
    "position": [150, 200]
  }
}
```

## é›†æˆåˆ°ç°æœ‰é¡¹ç›®

### 1. æ·»åŠ BrowserManager

åœ¨ä¸»åœºæ™¯ä¸­æ·»åŠ BrowserManagerèŠ‚ç‚¹ï¼š

```gdscript
# Main.gd
@onready var browser_manager: BrowserManager = $BrowserManager

func _ready() -> void:
    browser_manager.start_browser_system()
    browser_manager.browser_ready.connect(_on_browser_ready)

func _on_browser_ready() -> void:
    browser_manager.navigate_to_url("http://localhost:3000")
```

### 2. å¤„ç†AGUIå‘½ä»¤

```gdscript
func _on_agui_command_received(command: String, params: Dictionary) -> void:
    match command:
        "text_instruction":
            var text = params.get("text", "")
            # å‘é€æŒ‡ä»¤åˆ°è¡Œä¸ºæ ‘ç³»ç»Ÿ
            send_instruction_to_ai(text)
        "play_animation":
            var animation = params.get("animation", "")
            # æ’­æ”¾æŒ‡å®šåŠ¨ç”»
            pet.play_animation(animation)
```

### 3. æ›´æ–°å® ç‰©çŠ¶æ€

```gdscript
func update_pet_status(energy: float, boredom: float, current_action: String) -> void:
    if browser_manager:
        var status = {
            "energy": energy,
            "boredom": boredom,
            "current_action": current_action
        }
        browser_manager.send_browser_command("update_status", status)
```

## æ€§èƒ½ä¼˜åŒ–

### æ¸²æŸ“ä¼˜åŒ–
- **é€‰æ‹©æ€§æ›´æ–°**ï¼šåªåœ¨å†…å®¹å˜åŒ–æ—¶æ›´æ–°çº¹ç†
- **åˆ†è¾¨ç‡æ§åˆ¶**ï¼šæ ¹æ®è·ç¦»è°ƒæ•´æ˜¾ç¤ºåˆ†è¾¨ç‡
- **LODç³»ç»Ÿ**ï¼šè¿œè·ç¦»æ—¶é™ä½æ›´æ–°é¢‘ç‡

### å†…å­˜ç®¡ç†
- **çº¹ç†å¤ç”¨**ï¼šå¤ç”¨æµè§ˆå™¨çº¹ç†èµ„æº
- **åŠæ—¶æ¸…ç†**ï¼šæ¸…ç†ä¸ç”¨çš„æµè§ˆå™¨å®ä¾‹
- **è¿›ç¨‹ç›‘æ§**ï¼šé˜²æ­¢æµè§ˆå™¨å†…å­˜æ³„æ¼

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. æµè§ˆå™¨æ— æ³•å¯åŠ¨
**æ£€æŸ¥ï¼š**
- Chromeæµè§ˆå™¨æ˜¯å¦æ­£ç¡®å®‰è£…
- æµè§ˆå™¨è·¯å¾„é…ç½®æ˜¯å¦æ­£ç¡®
- é˜²ç«å¢™æ˜¯å¦é˜»æ­¢äº†æµè§ˆå™¨å¯åŠ¨

#### 2. WebSocketè¿æ¥å¤±è´¥
**æ£€æŸ¥ï¼š**
- AGUIæœåŠ¡å™¨æ˜¯å¦æ­£åœ¨è¿è¡Œ (`npm start`)
- ç«¯å£8080æ˜¯å¦è¢«å ç”¨
- ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸

#### 3. æµè§ˆå™¨å†…å®¹ä¸æ˜¾ç¤º
**æ£€æŸ¥ï¼š**
- VirtualBrowser3Dç»„ä»¶æ˜¯å¦æ­£ç¡®é…ç½®
- æµè§ˆå™¨è¿›ç¨‹æ˜¯å¦åœ¨å‘é€æˆªå›¾æ•°æ®
- çº¹ç†æ ¼å¼æ˜¯å¦æ­£ç¡®

#### 4. é¼ æ ‡äº¤äº’ä¸å“åº”
**æ£€æŸ¥ï¼š**
- BrowserInputManageræ˜¯å¦æ­£ç¡®é…ç½®
- ç›¸æœºèŠ‚ç‚¹æ˜¯å¦è®¾ç½®
- äº¤äº’è·ç¦»è®¾ç½®æ˜¯å¦åˆç†

### è°ƒè¯•å·¥å…·

å¯ç”¨è°ƒè¯•æ¨¡å¼æŸ¥çœ‹è¯¦ç»†æ—¥å¿—ï¼š
```gdscript
# åœ¨BrowserManagerä¸­
browser_manager.debug_mode = true
```

## æ‰©å±•å¼€å‘

### æ·»åŠ æ–°AGUIåŠŸèƒ½

1. **ä¿®æ”¹HTMLç•Œé¢** (`docs/agui_interface.html`)
2. **æ·»åŠ JavaScriptå¤„ç†** (åœ¨HTMLä¸­)
3. **æ‰©å±•WebSocketåè®®** (`scripts/agui_server.js`)
4. **å®ç°Godotç«¯å¤„ç†** (åœ¨BrowserManagerä¸­)

### è‡ªå®šä¹‰æµè§ˆå™¨æ˜¾ç¤º

```gdscript
# åˆ›å»ºè‡ªå®šä¹‰VirtualBrowser3D
class CustomBrowser extends VirtualBrowser3D:
    func _setup_browser_display() -> void:
        super._setup_browser_display()
        # æ·»åŠ è‡ªå®šä¹‰æ•ˆæœï¼Œå¦‚è¾¹æ¡†åŠ¨ç”»ã€é˜´å½±ç­‰
```

## æŠ€æœ¯è§„æ ¼

- **Godotç‰ˆæœ¬**: 4.2+
- **Node.jsç‰ˆæœ¬**: 16+
- **WebSocketç«¯å£**: 8080
- **HTTPç«¯å£**: 3000
- **æ”¯æŒæµè§ˆå™¨**: Chrome/Chromium 90+
- **å›¾åƒæ ¼å¼**: PNG (æ¨è)

## æ›´æ–°æ—¥å¿—

### v1.0.0 (2025-01-21)
- âœ… åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- âœ… åŸºç¡€æµè§ˆå™¨è¿›ç¨‹ç®¡ç†
- âœ… 3Dæµè§ˆå™¨æ˜¾ç¤ºç»„ä»¶
- âœ… WebSocketé€šä¿¡åè®®
- âœ… AGUIç•Œé¢å’ŒæœåŠ¡å™¨
- âœ… è¾“å…¥äº¤äº’ç³»ç»Ÿ
- âœ… æ¼”ç¤ºåœºæ™¯å’Œæ–‡æ¡£

## è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

1. Forké¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»ºPull Request

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚